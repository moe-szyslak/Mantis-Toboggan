/* eslint no-console: 0 */

import React, { Component, PropTypes } from 'react';

import NativeLink from './NativeLink.jsx';
import store from '../redux/store';
import { poster } from '../redux/action/showtime';
import containsFidel from '../util/containsFidel';

const placeholderPoster = 'data:image/png;base64,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';
const certifiedFresh = 'data:image/png;base64,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';
const freshTomato = 'data:image/png;base64,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';
const rotten = 'data:image/png;base64,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';

const posterUrls = Object.create(null); // unrelated state update will trigger poster action

class Cinema extends Component {
  constructor(props) {
    super(props);

    const state = store.getState();
    this.state = {
      poster: state.poster,
      show: state.showtime.show,
    };
  }

  componentDidMount() {
    this.unsubscribe = store.subscribe(() => {
      const state = store.getState();
      this.setState({
        poster: state.poster,
        show: state.showtime.show,
      });
    });
  }

  componentWillUnmount() {
    this.unsubscribe();
  }

  /**
   * given posterUrl, requests poster API if not found in LF
   *
   * @param  {String} posterUrl
   */
  poster(posterUrl) {
    if (Object.prototype.hasOwnProperty.call(posterUrls, posterUrl) === false) {
      posterUrls[posterUrl] = posterUrl; // blocking _other_ sate update calls
      poster(posterUrl);
    }

    return placeholderPoster;
  }

  render() {
    return (
      <div className="view-showtime-list">
        {
          this.state.show[this.props.params.cinema].map((movie, index) =>
            <NativeLink key={index} to={`/show/${this.props.params.cinema}/${index}`} className="movie-container">
              <div className="poster-container">
                <img
                  className="img-poster"
                  src={encodeURI(this.state.poster[movie.poster] || this.poster(movie.poster))}
                  alt={movie.title}
                />
              </div>

              <div className="info-container">
                <div className={`movie-title ${containsFidel(movie.title) ? '_am_' : ''}`}>{ movie.title }</div>
                <div className="movie-showtime _am_">{movie.time}</div>
                {
                  movie.omdb && !Number.isNaN(Number(movie.omdb.tomatoMeter)) ?
                    <div className="movie-score-container">
                      <img
                        className="movie-score-img"
                        alt="tomato meter"
                        src={Number(movie.omdb.tomatoMeter) > 70 ? certifiedFresh : Number(movie.omdb.tomatoMeter) > 59 ? freshTomato : rotten}
                      />
                      <span className="movie-score">{movie.omdb.tomatoMeter}</span>
                    </div>
                    : <span />
                }
              </div>
            </NativeLink>,
          )
        }

        { this.props.children }
      </div>
    );
  }
}

Cinema.propTypes = {
  children: PropTypes.element,
  params: PropTypes.shape({
    cinema: PropTypes.string.isRequired,
  }).isRequired,
};

Cinema.defaultProps = {};

module.exports = Cinema;
